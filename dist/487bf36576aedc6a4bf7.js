import"../scss/main.scss";import cloudyIcon from"../assets/svg_icons/cloudy.svg";import rainIcon from"../assets/svg_icons/raindrop.svg";import thunderIcon from"../assets/svg_icons/thunderstorms.svg";import drizzleIcon from"../assets/svg_icons/drizzle.svg";import snowIcon from"../assets/svg_icons/snow.svg";import clearDayIcon from"../assets/svg_icons/clear-day.svg";const weatherList=document.querySelector("#weatherList"),searchForm=document.querySelector("#searchForm"),searchInput=document.querySelector("#searchInput"),weeklyWeatherList=document.querySelector("#weatherList"),weatherTemplate=document.querySelector("#weatherTemplate").content,API="https://api.openweathermap.org/data/2.5/weather",weatherData=[{cod:"200",message:0,cnt:40,list:[{dt:1670101200,main:{temp:-.64,feels_like:-3.07,temp_min:-.64,temp_max:.14,pressure:1029,sea_level:1029,grnd_level:978,humidity:70,temp_kf:-.78},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04n"}],clouds:{all:100},wind:{speed:1.9,deg:325,gust:2.16},visibility:1e4,pop:0,sys:{pod:"n"},dt_txt:"2022-12-03 21:00:00"},{dt:1670112e3,main:{temp:-.46,feels_like:-.46,temp_min:-.46,temp_max:-.18,pressure:1030,sea_level:1030,grnd_level:978,humidity:56,temp_kf:-.28},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04n"}],clouds:{all:100},wind:{speed:1.3,deg:309,gust:1.4},visibility:1e4,pop:0,sys:{pod:"n"},dt_txt:"2022-12-04 00:00:00"},{dt:1670122800,main:{temp:-.39,feels_like:-.39,temp_min:-.39,temp_max:-.39,pressure:1032,sea_level:1032,grnd_level:978,humidity:41,temp_kf:0},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04d"}],clouds:{all:100},wind:{speed:1.19,deg:274,gust:1.42},visibility:1e4,pop:0,sys:{pod:"d"},dt_txt:"2022-12-04 03:00:00"},{dt:1670133600,main:{temp:1.16,feels_like:-.59,temp_min:1.16,temp_max:1.16,pressure:1032,sea_level:1032,grnd_level:979,humidity:36,temp_kf:0},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04d"}],clouds:{all:100},wind:{speed:1.61,deg:269,gust:1.39},visibility:1e4,pop:0,sys:{pod:"d"},dt_txt:"2022-12-04 06:00:00"},{dt:1670144400,main:{temp:2.02,feels_like:.56,temp_min:2.02,temp_max:2.02,pressure:1031,sea_level:1031,grnd_level:978,humidity:34,temp_kf:0},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04d"}],clouds:{all:100},wind:{speed:1.49,deg:257,gust:1.17},visibility:1e4,pop:.27,sys:{pod:"d"},dt_txt:"2022-12-04 09:00:00"},{dt:1670155200,main:{temp:1.08,feels_like:-1.15,temp_min:1.08,temp_max:1.08,pressure:1031,sea_level:1031,grnd_level:978,humidity:46,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.96,deg:214,gust:2.03},visibility:9853,pop:.34,snow:{"3h":.27},sys:{pod:"n"},dt_txt:"2022-12-04 12:00:00"},{dt:1670166e3,main:{temp:.22,feels_like:-2.01,temp_min:.22,temp_max:.22,pressure:1032,sea_level:1032,grnd_level:978,humidity:50,temp_kf:0},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04n"}],clouds:{all:100},wind:{speed:1.85,deg:233,gust:2.37},visibility:1e4,pop:.33,sys:{pod:"n"},dt_txt:"2022-12-04 15:00:00"},{dt:1670176800,main:{temp:-.1,feels_like:-1.85,temp_min:-.1,temp_max:-.1,pressure:1032,sea_level:1032,grnd_level:979,humidity:49,temp_kf:0},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04n"}],clouds:{all:100},wind:{speed:1.49,deg:240,gust:1.88},visibility:1e4,pop:.33,sys:{pod:"n"},dt_txt:"2022-12-04 18:00:00"},{dt:1670187600,main:{temp:-.64,feels_like:-.64,temp_min:-.64,temp_max:-.64,pressure:1032,sea_level:1032,grnd_level:979,humidity:57,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.09,deg:224,gust:1.42},visibility:1e4,pop:.61,snow:{"3h":.11},sys:{pod:"n"},dt_txt:"2022-12-04 21:00:00"},{dt:1670198400,main:{temp:-2.4,feels_like:-4.88,temp_min:-2.4,temp_max:-2.4,pressure:1033,sea_level:1033,grnd_level:979,humidity:88,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.74,deg:276,gust:1.71},visibility:334,pop:.74,snow:{"3h":.65},sys:{pod:"n"},dt_txt:"2022-12-05 00:00:00"},{dt:1670209200,main:{temp:-2.8,feels_like:-5.81,temp_min:-2.8,temp_max:-2.8,pressure:1034,sea_level:1034,grnd_level:980,humidity:93,temp_kf:0},weather:[{id:601,main:"Snow",description:"snow",icon:"13d"}],clouds:{all:100},wind:{speed:2.07,deg:301,gust:2.28},visibility:189,pop:.9,snow:{"3h":2.34},sys:{pod:"d"},dt_txt:"2022-12-05 03:00:00"},{dt:167022e4,main:{temp:-2.62,feels_like:-5.53,temp_min:-2.62,temp_max:-2.62,pressure:1035,sea_level:1035,grnd_level:981,humidity:93,temp_kf:0},weather:[{id:601,main:"Snow",description:"snow",icon:"13d"}],clouds:{all:100},wind:{speed:2.02,deg:291,gust:1.86},visibility:185,pop:.94,snow:{"3h":2.28},sys:{pod:"d"},dt_txt:"2022-12-05 06:00:00"},{dt:1670230800,main:{temp:-2.24,feels_like:-4.93,temp_min:-2.24,temp_max:-2.24,pressure:1035,sea_level:1035,grnd_level:981,humidity:94,temp_kf:0},weather:[{id:601,main:"Snow",description:"snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.9,deg:310,gust:1.82},visibility:212,pop:.94,snow:{"3h":1.84},sys:{pod:"d"},dt_txt:"2022-12-05 09:00:00"},{dt:1670241600,main:{temp:-2.29,feels_like:-4.21,temp_min:-2.29,temp_max:-2.29,pressure:1035,sea_level:1035,grnd_level:981,humidity:96,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.41,deg:315,gust:1.58},visibility:358,pop:.86,snow:{"3h":1.3},sys:{pod:"n"},dt_txt:"2022-12-05 12:00:00"},{dt:1670252400,main:{temp:-2.55,feels_like:-2.55,temp_min:-2.55,temp_max:-2.55,pressure:1035,sea_level:1035,grnd_level:981,humidity:96,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:99},wind:{speed:.91,deg:324,gust:.91},visibility:1571,pop:.61,snow:{"3h":.56},sys:{pod:"n"},dt_txt:"2022-12-05 15:00:00"},{dt:1670263200,main:{temp:-2.9,feels_like:-2.9,temp_min:-2.9,temp_max:-2.9,pressure:1034,sea_level:1034,grnd_level:980,humidity:95,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:99},wind:{speed:1.15,deg:348,gust:1.39},visibility:3084,pop:.5,snow:{"3h":.21},sys:{pod:"n"},dt_txt:"2022-12-05 18:00:00"},{dt:1670274e3,main:{temp:-2.42,feels_like:-2.42,temp_min:-2.42,temp_max:-2.42,pressure:1033,sea_level:1033,grnd_level:979,humidity:96,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.14,deg:357,gust:1.27},visibility:1238,pop:.57,snow:{"3h":.25},sys:{pod:"n"},dt_txt:"2022-12-05 21:00:00"},{dt:1670284800,main:{temp:-2.08,feels_like:-2.08,temp_min:-2.08,temp_max:-2.08,pressure:1032,sea_level:1032,grnd_level:978,humidity:96,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.11,deg:321,gust:1.31},visibility:578,pop:.65,snow:{"3h":1.24},sys:{pod:"n"},dt_txt:"2022-12-06 00:00:00"},{dt:1670295600,main:{temp:-2.08,feels_like:-2.08,temp_min:-2.08,temp_max:-2.08,pressure:1032,sea_level:1032,grnd_level:979,humidity:97,temp_kf:0},weather:[{id:601,main:"Snow",description:"snow",icon:"13d"}],clouds:{all:100},wind:{speed:.96,deg:285,gust:1.05},visibility:195,pop:.77,snow:{"3h":1.65},sys:{pod:"d"},dt_txt:"2022-12-06 03:00:00"},{dt:1670306400,main:{temp:-1.27,feels_like:-1.27,temp_min:-1.27,temp_max:-1.27,pressure:1033,sea_level:1033,grnd_level:979,humidity:98,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.2,deg:248,gust:1.12},visibility:182,pop:.86,snow:{"3h":1.35},sys:{pod:"d"},dt_txt:"2022-12-06 06:00:00"},{dt:1670317200,main:{temp:-.64,feels_like:-.64,temp_min:-.64,temp_max:-.64,pressure:1032,sea_level:1032,grnd_level:978,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13d"}],clouds:{all:100},wind:{speed:.95,deg:273,gust:.75},visibility:167,pop:.86,snow:{"3h":1.06},sys:{pod:"d"},dt_txt:"2022-12-06 09:00:00"},{dt:1670328e3,main:{temp:-.61,feels_like:-.61,temp_min:-.61,temp_max:-.61,pressure:1032,sea_level:1032,grnd_level:979,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:.75,deg:308,gust:.77},visibility:293,pop:.86,snow:{"3h":1.18},sys:{pod:"n"},dt_txt:"2022-12-06 12:00:00"},{dt:1670338800,main:{temp:-.96,feels_like:-.96,temp_min:-.96,temp_max:-.96,pressure:1033,sea_level:1033,grnd_level:979,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:.53,deg:343,gust:.48},visibility:1437,pop:.53,snow:{"3h":.59},sys:{pod:"n"},dt_txt:"2022-12-06 15:00:00"},{dt:1670349600,main:{temp:-2.01,feels_like:-2.01,temp_min:-2.01,temp_max:-2.01,pressure:1032,sea_level:1032,grnd_level:978,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:.59,deg:344,gust:.63},visibility:1e4,pop:.34,snow:{"3h":.11},sys:{pod:"n"},dt_txt:"2022-12-06 18:00:00"},{dt:1670360400,main:{temp:-1.83,feels_like:-1.83,temp_min:-1.83,temp_max:-1.83,pressure:1031,sea_level:1031,grnd_level:978,humidity:98,temp_kf:0},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04n"}],clouds:{all:100},wind:{speed:.64,deg:13,gust:.64},visibility:3516,pop:.04,sys:{pod:"n"},dt_txt:"2022-12-06 21:00:00"},{dt:1670371200,main:{temp:-.96,feels_like:-.96,temp_min:-.96,temp_max:-.96,pressure:1031,sea_level:1031,grnd_level:977,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:.44,deg:293,gust:.74},visibility:457,pop:.28,snow:{"3h":.25},sys:{pod:"n"},dt_txt:"2022-12-07 00:00:00"},{dt:1670382e3,main:{temp:-.49,feels_like:-.49,temp_min:-.49,temp_max:-.49,pressure:1031,sea_level:1031,grnd_level:978,humidity:98,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.15,deg:326,gust:1.62},visibility:1009,pop:.49,snow:{"3h":.59},sys:{pod:"d"},dt_txt:"2022-12-07 03:00:00"},{dt:1670392800,main:{temp:.04,feels_like:.04,temp_min:.04,temp_max:.04,pressure:1032,sea_level:1032,grnd_level:978,humidity:100,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.27,deg:352,gust:1.64},visibility:55,pop:.96,snow:{"3h":1.29},sys:{pod:"d"},dt_txt:"2022-12-07 06:00:00"},{dt:1670403600,main:{temp:.16,feels_like:-1.79,temp_min:.16,temp_max:.16,pressure:1031,sea_level:1031,grnd_level:977,humidity:100,temp_kf:0},weather:[{id:601,main:"Snow",description:"snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.64,deg:339,gust:2.38},visibility:30,pop:1,snow:{"3h":2.51},sys:{pod:"d"},dt_txt:"2022-12-07 09:00:00"},{dt:1670414400,main:{temp:.13,feels_like:.13,temp_min:.13,temp_max:.13,pressure:1031,sea_level:1031,grnd_level:978,humidity:100,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.33,deg:352,gust:2.26},visibility:26,pop:1,snow:{"3h":1.42},sys:{pod:"n"},dt_txt:"2022-12-07 12:00:00"},{dt:1670425200,main:{temp:.16,feels_like:-1.44,temp_min:.16,temp_max:.16,pressure:1031,sea_level:1031,grnd_level:978,humidity:100,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.42,deg:348,gust:2.2},visibility:29,pop:.95,snow:{"3h":.86},sys:{pod:"n"},dt_txt:"2022-12-07 15:00:00"},{dt:1670436e3,main:{temp:-.07,feels_like:-2.02,temp_min:-.07,temp_max:-.07,pressure:1031,sea_level:1031,grnd_level:977,humidity:100,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.62,deg:318,gust:2.02},visibility:808,pop:.81,snow:{"3h":.17},sys:{pod:"n"},dt_txt:"2022-12-07 18:00:00"},{dt:1670446800,main:{temp:-.3,feels_like:-1.86,temp_min:-.3,temp_max:-.3,pressure:1030,sea_level:1030,grnd_level:977,humidity:99,temp_kf:0},weather:[{id:804,main:"Clouds",description:"overcast clouds",icon:"04n"}],clouds:{all:100},wind:{speed:1.36,deg:342,gust:1.85},visibility:3448,pop:.3,sys:{pod:"n"},dt_txt:"2022-12-07 21:00:00"},{dt:1670457600,main:{temp:-.72,feels_like:-2.59,temp_min:-.72,temp_max:-.72,pressure:1031,sea_level:1031,grnd_level:977,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.51,deg:317,gust:2.1},visibility:3473,pop:.27,snow:{"3h":.16},sys:{pod:"n"},dt_txt:"2022-12-08 00:00:00"},{dt:1670468400,main:{temp:-.35,feels_like:-.35,temp_min:-.35,temp_max:-.35,pressure:1031,sea_level:1031,grnd_level:978,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.24,deg:326,gust:1.7},visibility:1680,pop:.31,snow:{"3h":.11},sys:{pod:"d"},dt_txt:"2022-12-08 03:00:00"},{dt:1670479200,main:{temp:.22,feels_like:-1.24,temp_min:.22,temp_max:.22,pressure:1032,sea_level:1032,grnd_level:979,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.34,deg:309,gust:1.65},visibility:1124,pop:.27,snow:{"3h":.16},sys:{pod:"d"},dt_txt:"2022-12-08 06:00:00"},{dt:167049e4,main:{temp:.27,feels_like:-1.66,temp_min:.27,temp_max:.27,pressure:1031,sea_level:1031,grnd_level:978,humidity:100,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13d"}],clouds:{all:100},wind:{speed:1.64,deg:306,gust:2.18},visibility:267,pop:.69,snow:{"3h":.66},sys:{pod:"d"},dt_txt:"2022-12-08 09:00:00"},{dt:1670500800,main:{temp:-.44,feels_like:-3.2,temp_min:-.44,temp_max:-.44,pressure:1032,sea_level:1032,grnd_level:978,humidity:99,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:2.19,deg:310,gust:3.14},visibility:77,pop:.73,snow:{"3h":1.1},sys:{pod:"n"},dt_txt:"2022-12-08 12:00:00"},{dt:1670511600,main:{temp:-.98,feels_like:-3.4,temp_min:-.98,temp_max:-.98,pressure:1032,sea_level:1032,grnd_level:979,humidity:98,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:1.85,deg:303,gust:2.45},visibility:113,pop:.9,snow:{"3h":1.4},sys:{pod:"n"},dt_txt:"2022-12-08 15:00:00"},{dt:1670522400,main:{temp:-1.52,feels_like:-4.44,temp_min:-1.52,temp_max:-1.52,pressure:1032,sea_level:1032,grnd_level:978,humidity:98,temp_kf:0},weather:[{id:600,main:"Snow",description:"light snow",icon:"13n"}],clouds:{all:100},wind:{speed:2.17,deg:297,gust:2.81},visibility:149,pop:.94,snow:{"3h":1.05},sys:{pod:"n"},dt_txt:"2022-12-08 18:00:00"}],city:{id:1512569,name:"Tashkent",coord:{lat:41.2646,lon:69.2163},country:"UZ",population:1978028,timezone:18e3,sunrise:1670034674,sunset:1670068485}}];async function makeRequest(e,t={}){try{const i=Object.entries(t).map((e=>`${e[0]}=${e[1]}&appid=2300d429630058871993058db910a620`)).join("&"),s=await fetch(`${e}?${i}`);return await s.json()}catch(e){return e}}async function getWeatherInfo(e="tashkent"){setDailyWeather(await makeRequest(API,{q:e,units:"metric"}))}function setDailyWeather(e){const t=document.querySelector("#dailyWeatherImg"),i=document.querySelector("#dailyWeatherType"),s=document.querySelector("#dailyWeatherLocation"),n=document.querySelector("#dailyWeatherLevel"),d=document.querySelector("#dailyHumidity"),l=document.querySelector("#dailyAirPressure"),{main:o,name:p,clouds:m,id:a,dt:r,wind:_,weather:u}=(document.querySelector("#dailyChanceOfRain"),e),{temp:c,pressure:w,humidity:h}=o,{speed:y}=_,g=u[0].description;n.textContent=`${Math.round(c)} C`,i.textContent=g,s.textContent=p,d.textContent=`${h}%`,l.textContent=`${w} PS`,t.src=getWeatherImage(a)}function getWeatherImage(e){return e>=200&&e<=232?thunderIcon:e>=300&&e<=321?drizzleIcon:e>=500&&e<=531?rainIcon:e>=600&&e<=631?snowIcon:e>=700&&e<=781?cloudyIcon:800===e?clearDayIcon:cloudyIcon}function renderWeeklyWeather(e,t){const i=new DocumentFragment;t.innerHTML="",e.forEach((e=>{const{dt:t,dt_txt:s,main:n,weather:d,wind:l}=e,{speed:o}=l,{temp:p}=n,m=(d[0].main,d[0].description),a=weatherTemplate.cloneNode(!0).children[0];a.querySelector("#weatherTime").textContent=returnTime(s),a.querySelector("#weatherDay").textContent=getDay(s),a.querySelector("#weatherListLevel").textContent=`${Math.round(p)} C`,a.querySelector("#weatherDescription").textContent=m,a.dataset.date=s,i.appendChild(a)})),t.appendChild(i)}async function getWeeklyWeather(e="tashkent"){renderWeeklyWeather((await makeRequest("http://api.openweathermap.org/data/2.5/forecast",{q:e,units:"metric"})).list,weeklyWeatherList)}function getDay(e){return{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"}[new Date(e).getDay()]}function returnTime(e){return e.split(" ")[1]}searchForm.addEventListener("submit",(e=>{e.preventDefault();const t=searchInput.value;getWeatherInfo(t),getWeeklyWeather(t)})),getWeatherInfo(),renderWeeklyWeather(weatherData[0].list,weeklyWeatherList);